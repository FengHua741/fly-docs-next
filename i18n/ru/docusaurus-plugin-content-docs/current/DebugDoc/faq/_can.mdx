---- 

# Определение проблемы по ошибкам

    * Ниже приведены常见 ошибки:
        * OSError: [Errno 19] Нет такого устройства
        * can.CanError: Не удалось передать: [Errno 100] Сеть отключена
        * can.CanError: Не удалось передать: [Errno 105] Нет доступного буфера
    * Первый тип ошибки указывает на то, что хост-компьютер не может найти устройство с ID `1d50:606f`
    * Второй тип ошибки означает, что хост-компьютер не настроен или настроен неправильно для CAN0
    * Третий тип ошибки указывает на недостаток буферов в хост-компьютере или системные проблемы, которые могут вызвать сбой буфера
    * Второй и третий типы ошибок можно устранить, выполнив настройку CAN0, описанную ниже
    * Если не удается найти UUID, см. раздел внизу

## Проверка поддержки CAN на хост-компьютере

    * Для FLY-хост-компьютера выполнение данного шага не требуется
    * Если ваша система — Ubuntu, рекомендуется заменить систему, так как настройка CAN на этом дистрибутиве сложная, рекомендуется использовать другую ОС
    * Введите следующую команду, чтобы определить, поддерживает ли ядро системы CAN

    ```bash
    sudo modprobe can && echo "Ваше ядро поддерживает CAN" || echo "Ваше ядро не поддерживает CAN"
    ```

    * После ввода команды, если ваше ядро поддерживает CAN, будет выведено: «Ваше ядро поддерживает CAN»; если нет, будет выведено: «Ваше ядро не поддерживает CAN».

## Настройка CAN0

    * Данная команда перезаписывает предыдущие настройки CAN0, после выполнения команды необходимо перезагрузить систему
    
    * Для скорости 1 Мбит введите следующую команду
----
    ```bash
    sudo /bin/sh -c "cat > /etc/network/interfaces.d/can0" << EOF
        allow-hotplug can0
        iface can0 can static
            bitrate 1000000
            up ifconfig can0 txqueuelen 1024
            pre-up ip link set can0 type can bitrate 1000000
            pre-up ip link set can0 txqueuelen 1024
    EOF
    ```
----
    * Для скорости 500 Кбит введите следующую команду

    ```bash
    sudo /bin/sh -c "cat > /etc/network/interfaces.d/can0" << EOF
    allow-hotplug can0
    iface can0 can static
        bitrate 500000
        up ifconfig can0 txqueuelen 1024
        pre-up ip link set can0 type can bitrate 500000
        pre-up ip link set can0 txqueuelen 1024
    EOF
    ```

    * Перезагрузите устройство

    ```bash
    sudo reboot
    ```


## Если не удается найти UUID, обратите внимание на следующие моменты

    * Если для Klipper настроены соответствующие UUID, их нужно сначала отключить в системной конфигурации, выключить устройство, отключить питание, затем включить устройство или нажать кнопку сброса на материнской плате
    * Совпадают ли скорость CAN на хост-компьютере с материнской платой, инструментальной платой и другими компонентами
    * Можно использовать следующий код для проверки скорости CAN на хост-компьютере
    * Убедитесь, что все соединения надежны
    ```bash
    ip -details link show can0
    ```
    * На изображении ниже показаны места, где можно увидеть скорость CAN на хост-компьютере и размер буфера
    * Верхнее число «1024» — текущая вместимость буфера CAN0
    * Нижнее число «1000000» — текущая скорость CAN0

    <ImageView image={require('@site/docs/DebugDoc/faq/img/details.webp').default} size="80%" align="center" />

    * Если UUID по-прежнему не найдены, тщательно проверьте следующие пункты

        * Проверьте правильность подключения материнской платы или платы CAN
        * Проверьте правильность подачи питания, рекомендуется подключить VCC
        * Проверьте поддержку CAN-сети хост-компьютером
        * Проверьте правильность компиляции прошивки

## Поиск UUID

    * Введите следующую команду для поиска UUID
    ```bash
    ~/klippy-env/bin/python ~/klipper/scripts/canbus_query.py can0
    ```
    * Если UUID найден и в конце выводится «Application: Klipper», значит данный UUID можно использовать напрямую
    * Если UUID найден и в конце выводится «Application: CANBOOT» или «Katapult», значит для использования этого UUID потребуется прошивка
    <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.webp').default} size="50%" align="left" />


## Метод настройки UUID

    * Откройте веб-интерфейс принтера, найдите раздел конфигурации в левом боковом меню: для fluidd — `{…}`, для mainsail — «Машина», затем откройте файл конфигурации `printer.cfg`

        <ImageView image={require('@site/docs/General/get-id/img/fluidd-cfg.webp').default} size="50%" align="left" />

    * Скопируйте найденный UUID и вставьте его в раздел `[mcu]` файла конфигурации `printer.cfg` в поле `canbus_uuid:`. После сохранения и перезагрузки устройство должно подключиться к материнской плате. Если Klipper выдает сообщение о необходимости обновления прошивки или возникают ошибки ADC, это означает, что соединение с материнской платой установлено успешно.

        <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.webp').default} size="50%" align="left" />

        :::danger

        Внимание: Все приведенные в документе UUID являются примерами, на каждой материнской плате UUID различаются. Замените значения на фактические UUID, полученные при настройке.

        :::
