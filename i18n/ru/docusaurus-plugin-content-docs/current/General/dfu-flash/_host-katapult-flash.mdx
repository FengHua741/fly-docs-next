:::tip
    * При установке программы для прошивки необходимо подключение к интернету, убедитесь, что ваш ПК успешно подключен к сети Интернет.
    * Если программа уже установлена, повторная установка не требуется.
:::

### Начало прошивки

    :::warning Предупреждение
       * Для **не fly ПК** обязательно выполните следующий код для установки зависимостей прошивки! В противном случае прошивка невозможна!
       ```
      cd && git clone https://github.com/Arksine/katapult.git
       ```
      <ImageView image={require('@site/docs/General/dfu-flash/img/get_katapult.webp').default} size="80%" align="center" />
    :::
    * Используйте нижеследующую команду для поиска ID устройства, должен появиться ID, как показано на изображении (примечание: ID на изображении приведен仅供参考, каждый материнский плат имеет уникальный ID)

        ```bash
        ls /dev/serial/by-id/*
        ```
        <ImageView image={require('@site/docs/General/dfu-flash/img/2040.webp').default} size="80%" align="center" />


    * Для прошивки firmware используйте нижеследующий код, убедитесь, что firmware скомпилирован, *замените `<ваш ID платы>` на ID, найденный на предыдущем шаге*

        ```bash
        ~/klippy-env/bin/python ~/katapult/scripts/flashtool.py -d /dev/serial/by-id/<ваш ID платы>
        ```

    * Ниже приведен пример
        <ImageView image={require('@site/docs/General/dfu-flash/img/kaulut7.webp').default} size="100%" align="center" />

    * После завершения прошивки пример
        <ImageView image={require('@site/docs/General/dfu-flash/img/katapult3.webp').default} size="100%" align="center" />

## Обновление firmware

<Tabs>
    <TabItem value="w" label="Обновление USB firmware" default>
    * Используйте нижеследующую команду для поиска ID устройства, должен появиться ID, как показано на изображении (примечание: ID на изображении приведен仅供参考, каждый материнский плат имеет уникальный ID)

        ```bash
        ls /dev/serial/by-id/*
        ```
    :::tip Примечание
        На следующем изображении `dev/serial/by-id/usb-katapult_rp2040_E662549553642032-if00` является ID платы
    :::
        <ImageView image={require('@site/docs/General/dfu-flash/img/2040.webp').default} size="80%" align="center" />

    * Для обновления USB firmware необходимо после компиляции последней версии firmware ввести следующую команду для обновления, *замените `<ваш ID платы>` на ID, найденный на предыдущем шаге*

        ```bash
        cd ~/klipper/ && make flash FLASH_DEVICE=<ваш ID платы>
        ```
       <ImageView image={require('@site/docs/General/dfu-flash/img/katapult5.webp').default} size="100%" align="center" />
    </TabItem>


    <TabItem value="l" label="Обновление CAN bridge firmware">
    * Для обновления CAN bridge firmware необходимо после компиляции последней версии firmware ввести следующую команду для перезагрузки в Katapult. (На следующем изображении ID является только для примера, пожалуйста, используйте ID из вашего конфигурационного файла)
    :::tip Примечание
       * `<ваш CANBUS UUID>` — это UUID платы в файле конфигурации **printer.cfg**
    :::
        
        <br/>

        ```bash
        ~/klippy-env/bin/python3 ~/katapult/scripts/flashtool.py -i can0 -r -u <ваш CANBUS UUID>
        ```
    :::tip Примечание
       * На следующем изображении `f95cee90e1f9` является UUID платы
    :::
        <ImageView image={require('@site/docs/General/dfu-flash/img/katapult6.webp').default} size="100%" align="center" />
    * После перезагрузки в Katapult используйте нижеследующую команду для поиска ID устройства, должен появиться ID, как показано на изображении (примечание: ID на изображении приведен仅供参考, каждый материнский плат имеет уникальный ID)

        ```bash
        ls /dev/serial/by-id/*
        ```
    :::tip Примечание
        На следующем изображении `dev/serial/by-id/usb-Klipper_stm32f072xb_43002C000951324757373520-if00` является ID платы
    :::
        <ImageView image={require('@site/docs/General/dfu-flash/img/katapult4.webp').default} size="80%" align="center" />

    * Убедитесь, что новая firmware скомпилирована перед выполнением команды прошивки. *замените `<ваш ID платы>` на ID, найденный на предыдущем шаге*

        ```bash
        cd ~/klipper/ && make flash FLASH_DEVICE=<ваш ID платы>
        ```
       <ImageView image={require('@site/docs/General/dfu-flash/img/katapult5.webp').default} size="100%" align="center" />
    </TabItem>

</Tabs>

## Решение проблемы с неверной прошивкой

* Отключите питание платы, снова включите и быстро дважды нажмите кнопку reset, чтобы снова войти в режим прошивки.
* Или используйте ПК/ПК верхнего уровня для повторной прошивки firmware katapult <Button variant="contained" disableElevation href="/docs/ProductDoc/MainBoard/fly-d/fly-d5/flash/bl#вход в режим dfu прошивки">прошивка firmware katapult</Button>
