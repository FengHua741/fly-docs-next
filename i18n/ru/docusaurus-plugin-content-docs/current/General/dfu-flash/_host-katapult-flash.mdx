:::tip
    * При установке программы для прошивки необходимо подключение к интернету. Убедитесь, что ваш компьютер уже успешно подсоединен к сети.
    * Если программа уже установлена, повторная установка не требуется.
:::

### Начало прошивки

    :::warning Предупреждение
       * **Если вы используете не-Fly ПК** обязательно выполните следующую команду для установки зависимостей прошивки! В противном случае прошивка не будет выполнена!
       ```
      cd && git clone https://github.com/Arksine/katapult.git
       ```
      <ImageView image={require('@site/docs/General/dfu-flash/img/get_katapult.webp').default} size="80%" align="center" />
    :::
    * Используйте нижеследующую команду для поиска ID вашего устройства, результат должен совпасть с изображением ниже (примечание: ID на картинке является примером, каждый материнский плат имеет уникальный ID).

        ```bash
        ls /dev/serial/by-id/*
        ```
        <ImageView image={require('@site/docs/General/dfu-flash/img/2040.webp').default} size="80%" align="center" />


    * Для прошивки используйте следующую команду, убедитесь, что прошивка уже скомпилирована, *замените `<ваш ID материнской платы>` на ID, найденный в предыдущем шаге*

        ```bash
        ~/klippy-env/bin/python ~/katapult/scripts/flashtool.py -d /dev/serial/by-id/<ваш ID материнской платы>
        ```
    Для системы `fast` используйте эту команду для прошивки, *замените `<ваш ID материнской платы>` на ID, найденный в предыдущем шаге*
    
            ```bash
            python ~/katapult/scripts/flashtool.py -d /dev/serial/by-id/<ваш ID материнской платы>
            ```
    * Пример ниже:
        <ImageView image={require('@site/docs/General/dfu-flash/img/kaulut7.webp').default} size="100%" align="center" />

    * Результат после завершения прошивки:
        <ImageView image={require('@site/docs/General/dfu-flash/img/katapult3.webp').default} size="100%" align="center" />

## Обновление прошивки

<Tabs>
    <TabItem value="w" label="Обновление USB-прошивки" default>
    * Используйте нижеследующую команду для поиска ID вашей материнской платы, результат должен совпасть с изображением ниже (примечание: ID на картинке является примером, каждый материнский плат имеет уникальный ID).

        ```bash
        ls /dev/serial/by-id/*
        ```
    :::tip Важно
        На следующем изображении `/dev/serial/by-id/usb-katapult_rp2040_E662549553642032-if00` является ID материнской платы.
    :::
        <ImageView image={require('@site/docs/General/dfu-flash/img/2040.webp').default} size="80%" align="center" />

    * Для обновления USB-прошивки потребуется компиляция новой прошивки. Затем выполните следующую команду, *замените `<ваш ID материнской платы>` на ID, найденный в предыдущем шаге*

        ```bash
        cd ~/klipper/ && make flash FLASH_DEVICE=<ваш ID материнской платы>
        ```
       <ImageView image={require('@site/docs/General/dfu-flash/img/katapult5.webp').default} size="100%" align="center" />
    </TabItem>


    <TabItem value="l" label="Обновление прошивки моста CAN">
    * Для обновления CAN-мостовой прошивки понадобится компиляция новой прошивки, затем выполните следующую команду для перезагрузки в Katapult. (На следующем изображении ID является примером, пожалуйста, используйте ID из вашей конфигурационной файлы)
    :::tip Важно
       * `<ваш CANBUS UUID>` — это UUID материнской платы в вашем файле конфигурации `printer.cfg`
    :::
        
        <br/>

        ```bash
        ~/klippy-env/bin/python3 ~/katapult/scripts/flashtool.py -i can0 -r -u <ваш CANBUS UUID>
        ```
    :::tip Важно
       * На следующем изображении `f95cee90e1f9` является UUID материнской платы.
    :::
        <ImageView image={require('@site/docs/General/dfu-flash/img/katapult6.webp').default} size="100%" align="center" />
    * После перезагрузки в Katapult используйте следующую команду для поиска ID вашей материнской платы, результат должен совпасть с изображением ниже (примечание: ID на картинке является примером, каждый материнский плат имеет уникальный ID)

        ```bash
        ls /dev/serial/by-id/*
        ```
    :::tip Важно
        На следующем изображении `/dev/serial/by-id/usb-Klipper_stm32f072xb_43002C000951324757373520-if00` является ID материнской платы.
    :::
        <ImageView image={require('@site/docs/General/dfu-flash/img/katapult4.webp').default} size="80%" align="center" />

    * Убедитесь, что новая прошивка скомпилирована перед выполнением операции записи. *замените `<ваш ID материнской платы>` на ID, найденный в предыдущем шаге*

        ```bash
        cd ~/klipper/ && make flash FLASH_DEVICE=<ваш ID материнской платы>
        ```
       <ImageView image={require('@site/docs/General/dfu-flash/img/katapult5.webp').default} size="100%" align="center" />
    </TabItem>

</Tabs>

## Метод решения проблемы при неправильной прошивке

* Отключите питание платы, затем снова включите и быстро дважды нажмите кнопку RESET, чтобы вернуться в режим прошивки.
* Или воспользуйтесь ПК под управлением Windows для повторной прошивки платы Katapult. <Button variant="contained" disableElevation href="/docs/ProductDoc/MainBoard/fly-d/fly-d5/flash/bl#вход-в-режим-dfu-прошивки">Прошивка платы Katapult</Button>
