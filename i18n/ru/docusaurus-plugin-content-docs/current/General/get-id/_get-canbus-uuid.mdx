## Настройка CAN и поиск ID

* Если вы планируете использовать CAN, убедитесь, что ваш ПК выполнен в соответствующей конфигурации.

----

:::danger Важно

Убедитесь, что материнская плата подключена к ПК перед выполнением дальнейших действий.

:::


:::warning

Пожалуйста, убедитесь, что сеть CAN на ПК, скорость CAN на мостовой плате материнской платы и скорость CAN-инструментальной платы полностью совпадают.

:::

### Примечания перед поиском устройства

    * Перед поиском ID CAN убедитесь, что вы [подключены к SSH](/docs/DebugDoc/BasicTutorial/index.mdx "Щелкните для перехода")
    * Обратите внимание, что необходимо войти в систему через сеть, а не через последовательный порт
    * Убедитесь, что подключена UTOC или прошитая CAN-мостовая плата материнской платы, и убедитесь, что соединительный кабель с ПК имеет функцию передачи данных

### Поиск устройства

    * Теперь, когда вы успешно вошли в систему ПК, можете ввести команду `lsusb`, чтобы найти устройство. Это может быть одна из следующих ситуаций:
        * При вводе команды `lsusb` появляется сообщение об отсутствии команды `ls`, тогда можно ввести следующую команду для установки:
            ```bash
            sudo apt-get install usbutils
            ```
        * После ввода команды `lsusb` ничего не происходит. Это проблема системы, и мы не можем помочь. Вам нужно заменить систему или использовать определённую рабочую систему.
        * Появляется информация, как показано на нижеследующем изображении. Это только пример. Важно лишь наличие `1d50:606f`
            <ImageView image={require('@site/docs/General/get-id/img/606f.webp').default} size="100%" align="left" />
    * `1d50:606f` принадлежит устройству, которое вы будете использовать. Дальнейшие подсказки не имеют значения, так как системные проблемы могут привести к неполной или полному отсутствию отображения
    * Если имеется несколько `1d50:606f`, рекомендуется исключить одно из них, чтобы избежать конфликтов при дальнейшей прошивке и подключении к фиктивным устройствам. Например, если используется FLY MINI PAD, лучше использовать встроенный UTOC, а не другие CAN-мостовые устройства
    * Если ничего не найдено, проверьте правильность подключения кабеля и корректность прошивки

:::warning Важное примечание
Действия с ID CAN можно производить только при наличии `1d50:606f`

:::

### Поиск ID CAN

    * Введите следующую команду для поиска ID:
    ```bash
    ~/klippy-env/bin/python ~/klipper/scripts/canbus_query.py can0
    ```
    * Если появляется ID и в конце `Application:` указано `Klipper`, значит данный ID может быть использован напрямую
    * Если появляется ID и в конце `Application:` указано `CANBOOT` или `Katapult`, значит для использования требуется прошивка
        <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.webp').default} size="50%" align="left" />


### Сборник проблем CAN

    :::danger Важно

    * Если не удалось найти ID CAN, обратитесь к документации ниже
    * <Button variant="contained" disableElevation component="a" rel="noopener" href="/docs/DebugDoc/faq/klipper_can">Сборник проблем CAN</Button>

    :::

### Заполнение ID CAN в конфигурации

    * Откройте веб-интерфейс принтера, найдите в левом боковом меню раздел настройки: для fluidd — `{…}`, для mainsail — «Машина», затем перейдите в файл `printer.cfg`

        <ImageView image={require('@site/docs/General/get-id/img/fluidd-cfg.webp').default} size="50%" align="left" />

    * Скопируйте полученный UUID и вставьте его в настройки `[mcu]` файла `printer.cfg` после `canbus_uuid:`. После сохранения и перезагрузки система должна подключиться к материнской плате. Если Klipper сообщает о необходимости обновления прошивки, ошибке ADC и т. д., это означает, что подключение к материнской плате установлено
    * Если в разделе `Application:` указано Canboot, то настройку невозможно произвести, требуется предварительно прошить firmware Klipper
        <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.webp').default} size="50%" align="left" />

        :::danger

        Важно: все ID, указанные в документации, являются примерами. Каждый процессор имеет уникальный ID. Пожалуйста, используйте фактический полученный ID.

        :::

    * Ниже приведён пример конфигурации
        :::danger

        * Ниже представлен пример конфигурации для одного процессора и одной инструментальной платы
        * Для материнской платы всегда используется `[mcu]` плюс `canbus_uuid:` и ID, полученный в ходе поиска
        * Для инструментальной платы всегда используется `[mcu имя_инструмента]` плюс `canbus_uuid:` и ID, полученный в ходе поиска
        :::
        <ImageView image={require('@site/docs/General/get-id/img/canid.webp').default} size="50%" align="left" />
