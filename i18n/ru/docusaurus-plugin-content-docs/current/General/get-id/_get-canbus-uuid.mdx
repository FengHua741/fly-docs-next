## Настройка CAN и поиск ID

* Если вы планируете использовать CAN, убедитесь, что ваш ПК настроен для работы с CAN.

----

:::danger Важно

Убедитесь, что материнская плата подключена к ПК перед выполнением дальнейших действий.

:::


:::warning

Убедитесь, что сеть CAN на ПК, скорость CAN на мостовой плате и скорость CAN на инструментальной плате полностью совпадают.

:::

### Примечания перед поиском устройства

    * Перед поиском CAN ID убедитесь, что вы [подключены к SSH](/docs/DebugDoc/BasicTutorial/index.mdx "щелкните для перехода").
    * Обратите внимание, что необходимо войти в систему через сеть, а не через последовательный порт.
    * Убедитесь, что подключена UTOC или прошитая платформа с мостовым CAN, и что соединительный кабель с ПК имеет функцию передачи данных.

### Поиск устройства

    * Теперь, когда вы успешно вошли в систему, можете ввести команду `lsusb`, чтобы найти устройство. Возможны следующие варианты:
        * Если ввод команды `lsusb` показывает ошибку "команда не найдена", введите следующую команду для установки:
            ```bash
            sudo apt-get install usbutils
            ```
        * Если после ввода команды `lsusb` ничего не происходит, это системная проблема, и мы бессильны. Вам нужно заменить систему или использовать рабочую систему.
        * Если появляется информация изображенная ниже, обратите внимание, что это только пример. Важно лишь наличие `1d50:606f`.
            <ImageView image={require('@site/docs/General/get-id/img/606f.webp').default} size="100%" align="left" />
    * `1d50:606f` принадлежит устройству, которое вы используете.
    * Если есть несколько `1d50:606f`, рекомендуется исключить один из них, чтобы не повлиять на дальнейшее программирование и подключение к фиктивной плате. Например, при использовании `FLY MINI PAD` лучше использовать встроенную UTOC, а не другие мостовые устройства CAN.
    * Если ничего не появилось, проверьте подключение кабеля и правильно ли установлены прошивки.

:::warning Важно

Используйте CAN ID только в том случае, если появился `1d50:606f`.

:::

### Поиск CAN ID

    * Введите следующую команду для поиска ID:
    ```bash
    ~/klippy-env/bin/python ~/klipper/scripts/canbus_query.py can0
    ```
    * Если появляется ID и в конце `Application:` указано `Klipper`, значит этот ID можно использовать.
    * Если появляется ID и в конце `Application:` указано `CANBOOT` или `Katapult`, значит требуется прошивка, чтобы использовать его.
        <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.webp').default} size="50%" align="left" />


### Сборник проблем с CAN

    :::danger Важно

    * Если не удается найти CAN ID, см. документацию ниже.
    * <Button variant="contained" disableElevation component="a" rel="noopener" href="/docs/DebugDoc/faq/klipper_can">Сборник проблем с CAN</Button>

    :::

### Заполнение CAN ID в конфигурации

  <table>
    <tr>
      <td>
        - Для fluidd: `{…}`, щелкните, чтобы найти `printer.cfg`
        <ImageView image={require('@site/docs/General/get-id/img/fluidd-cfg.webp').default} size="100%" align="center" />
      </td>
      <td>
        - Для mainsail: `машинка`, щелкните, чтобы найти `printer.cfg`
        <ImageView image={require('@site/docs/General/get-id/img/mainsail-cfg.webp').default} size="100%" align="center" />
      </td>
    </tr>
  </table>


    * Скопируйте полученный UUID и вставьте его в секцию `[mcu]` конфигурационного файла `printer.cfg` под ключом `canbus_uuid: `. После сохранения и перезагрузки система должна подключиться к материнской плате. Если Klipper выдает сообщение о необходимости обновления прошивки или ошибках ADC, это означает, что подключение к материнской плате успешно установлено.
    * Если `Application:` показывает Canboot, то невозможно добавить в конфигурацию. Необходимо прошить прошивку Klipper, чтобы продолжить.
        <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.webp').default} size="50%" align="left" />

        :::danger

        Важно: все ID, указанные в документации, являются примерами. На самом деле каждый процессор имеет уникальный ID. Пожалуйста, измените ID в соответствии с фактически полученным значением.

        :::

    * Ниже приведена ссылка на пример конфигурации:
        :::danger
        ```
        [mcu]
        canbus_uuid: <здесь замените на найденный ID>
        ```
        * Это пример конфигурации для одного процессора и одной инструментальной платы.
        * Если это ID процессора, то всегда используется `[mcu]` с добавлением `canbus_uuid:` и найденного ID.
        * Если это ID инструментальной платы, то всегда используется `[mcu имя_инструментальной_платы]` с добавлением `canbus_uuid:` и найденного ID.
        :::
        <ImageView image={require('@site/docs/General/get-id/img/canid.webp').default} size="50%" align="left" />
