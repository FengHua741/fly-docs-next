## Настройка CAN и поиск ID

:::warning

* Стандартная скорость CAN в системе FAST составляет 1 Мбит/с.
* Убедитесь, что скорость CAN в компьютере верхнего уровня, мостовой материнской платы и инструментальной платы CAN полностью совпадает.

:::

### Примечания перед поиском устройства

    * Перед поиском ID CAN убедитесь, что прошивка поддерживает USB-мост CAN.

## Поиск устройства
    * В командной строке введите `lsusb` и нажмите Enter. Если появляется информация, заштрихованная на изображении ниже, можно переходить к следующему шагу.
        * Если нет никакого ответа, это проблема системы верхнего уровня, мы бессильны, вам нужно заменить рабочую систему или заменить верхний уровень.
        * Если сообщается об отсутствии команды `lsusb`, выполните эту команду для установки:
            ```bash
            sudo apt-get install usbutils
            ```
        * Если после ввода `lsusb` ничего не происходит, это проблема системы, мы бессильны, вам нужно заменить систему или использовать проверенную рабочую систему.
        * При появлении информации на экране, как показано на изображении ниже, используйте это только как ориентир. Вам нужно просто убедиться в наличии `1d50:606f`.
            <ImageView image={require('@site/docs/General/get-id/img/606f.webp').default} size="100%" align="left" />
    * `1d50:606f` относится к устройству, которое вы будете использовать. Дальнейшие сообщения вам не нужны, так как проблемы системы могут привести к тому, что они не полностью отобразятся или вообще не отобразятся.
    * Если несколько раз встречается `1d50:606f`, убедитесь, что в машине есть только один USB-мост CAN или UTOC.
    * Если нет, проверьте, хорошо ли подключены кабели, правильно ли установлены прошивки.

:::warning Примечание
Для поиска ID CAN необходимо наличие `1d50:606f`.
:::

### Поиск ID CAN

    * Введите следующую команду для поиска ID:
    ```bash
    ~/klippy-env/bin/python ~/klipper/scripts/canbus_query.py can0
    ```
    * Если появляется ID и в конце `Application:` указано `Klipper`, это означает, что этот ID можно использовать.
    * Если появляется ID и в конце `Application:` указано `CANBOOT` или `Katapult`, это означает, что для использования требуется прошивка.
        <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.webp').default} size="50%" align="left" />


### Сборник проблем CAN

    :::danger Важно помнить

    * Если не удается найти ID CAN, обратитесь к документации ниже.  
    * <Button variant="contained" disableElevation component="a" rel="noopener" href="/docs/DebugDoc/faq/klipper_can">Сборник проблем CAN</Button>

    :::

### Заполнение ID CAN в конфигурацию

    * Откройте веб-интерфейс принтера, найдите в левом боковом меню раздел конфигурации: для fluidd — `{…}`, для mainsail — «Машина», и нажмите, чтобы найти файл `printer.cfg`.

        <ImageView image={require('@site/docs/General/get-id/img/fluidd-cfg.webp').default} size="50%" align="left" />

    * Скопируйте полученный UUID и запишите его в раздел `[mcu]` файла конфигурации `printer.cfg` под ключом `canbus_uuid:`. После сохранения и перезагрузки соединение с материнской платой должно быть установлено. Если Klipper сообщает о необходимости обновления прошивки, ошибке ADC и т.д., это означает, что соединение с материнской платой установлено.
    * Если `Application:` показывает Canboot, его нельзя добавить в конфигурацию, потребуется прошивка Klipper для дальнейших действий.
        <ImageView image={require('@site/docs/General/get-id/img/canbus-uuid.webp').default} size="50%" align="left" />

    * Ниже приведен пример конфигурации:
        :::danger

        * Это пример конфигурации для одного контроллера и одной инструментальной платы.
        * Если ID принадлежит материнской плате, обязательно добавьте `[mcu]` вместе с `canbus_uuid:` и найденным ID.
        * Если ID принадлежит инструментальной плате, обязательно добавьте `[mcu имя_инструментальной_платы]` вместе с `canbus_uuid:` и найденным ID.
        :::
        <ImageView image={require('@site/docs/General/get-id/img/canid.webp').default} size="50%" align="left" />

        :::danger

        Важно: Все ID, указанные в документации, являются примерами, каждый контроллер имеет уникальный ID, поэтому убедитесь, что вы используете фактически полученные ID.

        :::
