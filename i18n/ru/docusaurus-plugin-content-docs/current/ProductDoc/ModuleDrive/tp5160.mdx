---
sidebar_position: 9
---


import DIAG from '@site/i18n/ru/docusaurus-plugin-content-docs/current/ProductDoc/ModuleDrive/_diag.mdx';

# TP 5160

    <ImageView image={require('@site/docs/ProductDoc/ModuleDrive/img/tp5160.webp').default} size="60%" align="center" />

## TMC-5160

    * Диапазон входного напряжения: 12В–48В
    * Максимальный ток: 4.4А
    * Совместимость с прошивками: Marlin/Klipper/RRF
    * Поддерживаемые режимы работы двигателя: TMC: SPI
    * Интерфейс шаг/направление с поддержкой микроскалирования microPlyer
    * Максимальная разрешающая способность: 256 делений
    * Поддерживает работу в режиме stealthChop2 для бесшумной работы и плавных движений
    * Поддерживает сглаживание резонансов на средних частотах
    * Поддерживает алгоритм spreadCycle для высокодинамичного управления двигателем
    * Поддерживает dcStep для управления скоростью в зависимости от нагрузки
    * Поддерживает stallGuard2 для точного датирования нагрузки двигателя без датчиков
    * Поддерживает coolStep для управления током, экономящим до 75%

## Настройки по умолчанию для TP5160

    :::danger

    * Сопротивление образца драйвера равно `sense_resistor: 0.075`, не следует указывать неправильное значение
    * `spi_bus` и `spi_software` могут быть выбраны только один из двух
    
    :::

### Пример конфигурации в режиме SPI

    ```cfg
    [tmc5160 stepper_x]
    cs_pin:
    spi_bus:
    # spi_software_mosi_pin:
    # spi_software_miso_pin:
    # spi_software_sclk_pin: 
    run_current: 1.0                    # Значение тока при работе двигателя
    interpolate: False                  # Включить (True) или отключить (False) интерполяцию 256 микроделений
    sense_resistor: 0.075
    stealthchop_threshold: 0
    driver_DISS2G: 1
    driver_DISS2VS: 1
    ```

## Инструкция по использованию без концевиков

    <DIAG />

    :::tip Совет по использованию без концевиков
    
    * Для использования функции без концевиков TP5160 необходимо подключить перемычку DIAG на материнской плате
    * Нужно заблокировать или удалить существующую строку `endstop_pin:`, добавив `endstop_pin: tmc5160_stepper_x:virtual_endstop`
    * После настройки `diag1_pin:` статус концевика должен быть неактивным
    * Параметр `driver_SGT:` требует тестирования и подбора подходящего значения

    :::

    * Пример конфигурации

    ```cfg
    [stepper_x]
    # endstop_pin:PF3
    endstop_pin: tmc5160_stepper_x:virtual_endstop
    homing_retract_dist: 0        # Отступ обратно не изменять, иначе может произойти сбой при возврате

    [tmc5160 stepper_x]
    diag1_pin: ^!
    driver_SGT: 1

    # После настройки убедитесь, что статус концевика неактивен
    # Этот вывод обычно активируется с помощью префикса "^" для включения внутреннего подтягивающего резистора
    # Чувствительность зависит от натяжения ленты и требует настройки
    # (Убедитесь, что также установлен параметр driver_SGTHRS на подходящее значение)

    ```
