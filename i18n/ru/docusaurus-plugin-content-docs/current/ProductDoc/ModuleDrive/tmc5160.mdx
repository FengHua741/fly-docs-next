---
sidebar_position: 3
---



import DIAG from '@site/i18n/ru/docusaurus-plugin-content-docs/current/ProductDoc/ModuleDrive/_diag.mdx';

# TMC 5160

    <ImageView image={require('@site/docs/ProductDoc/ModuleDrive/img/5160.webp').default} size="80%" align="center" />

## Основные параметры

    * Напряжение питания: 12В–24В
    * Максимальный ток: 4.4А
    * Совместимость: прошивки Marlin/Klipper/RRF
    * Поддерживаемый режим работы двигателя: TMC: SPI
    * Интерфейс шаг/направление с поддержкой микроползания microPlyer
    * Максимальное разрешение: 256 мелкое деление
    * Поддержка тихой работы stealthChop2 и плавных движений
    * Подавление резонанса на средних частотах
    * Поддержка режектора spreadCycle для высокодинамичного управления двигателем
    * Поддержка dcStep для регулирования скорости в зависимости от нагрузки
    * Поддержка stallGuard2 для точного датчика нагрузки двигателя без датчиков
    * Поддержка coolStep для управления током, экономящего до 75% энергии

## Инструкция по настройке переключателей на материнской плате

    * Для работы TMC5160 используется конфигурация SPI
    * Пин SPI на FLY-драйвере находится под четвертым контактом сверху слева, CS — это пин SPI. Если пины на материнской плате не совпадают, то использование SPI невозможно.
        <ImageView image={require('@site/docs/ProductDoc/ModuleDrive/img/jumper.webp').default} size="100%" align="center" />


## Пример конфигурации TMC5160

    :::danger

    * Резистор для отбора сигнала имеет значение `sense_resistor: 0.075`, установите его правильно
    * Параметры `spi_bus` и `spi_software` могут быть выбраны только один из двух
    
    :::

### Пример конфигурации в режиме SPI

    ```cfg
    [tmc5160 stepper_x]
    cs_pin:
    spi_bus:
    # spi_software_mosi_pin:
    # spi_software_miso_pin:
    # spi_software_sclk_pin: 
    run_current: 1.0                    # Значение тока при работе двигателя
    interpolate: False                  # Включить ли микроползание (включено — True, выключено — False)
    sense_resistor: 0.075
    stealthchop_threshold: 0
    driver_DISS2G: 1
    driver_DISS2VS: 1
    ```

## Инструкция по использованию без концевиков

    <DIAG />

    :::tip Совет по использованию без концевиков

    * Этот драйвер требует пайки пина DIAG, иначе функция бесконцевиков будет недоступна
    * Исходный пин `endstop_pin:` нужно заблокировать или удалить, добавить `endstop_pin: tmc5160_stepper_x:virtual_endstop`
    * После настройки `diag1_pin:` состояние концевиков будет отображаться как неактивированное
    * Настройка `driver_SGT:` требует самостоятельного тестирования подходящего значения

    :::

    * Пример конфигурации

    ```cfg
    [stepper_x]
    # endstop_pin:PF3
    endstop_pin: tmc5160_stepper_x:virtual_endstop
    homing_retract_dist: 0        # Отступ при возврате не изменять, иначе может произойти сбой возвращения

    [tmc5160 stepper_x]
    diag1_pin: ^!
    driver_SGT: 1

    # После настройки убедитесь, что состояние концевиков не активировано
    # Этот пин обычно используется с префиксом "^" для включения внутреннего подтягивающего резистора
    # Сенситивность зависит от натяжения ремня и требует настройки
    # (убедитесь, что установлен параметр driver_SGTHRS на подходящее значение чувствительности)

    ```
