---
sidebar_position: 3
sidebar_label: CAN Firmware Burning
---

import CANFLASH from '@site/i18n/en/docusaurus-plugin-content-docs/current/General/dfu-flash/_host-can-flash.mdx';
import MakeOperate from "/docs/General/klipper-make/_make-operate.mdx";
import CAN from '@site/i18n/en/docusaurus-plugin-content-docs/current/General/dfu-flash/_firmware/2040/_can1.mdx';
import SSH from '@site/i18n/en/docusaurus-plugin-content-docs/current/General/dfu-flash/_firmware/_ssh.mdx';

import LS from '@site/i18n/en/docusaurus-plugin-content-docs/current/General/dfu-flash/_can.mdx';

# CAN Firmware Compilation

## Start Compilation

    <SSH />

    <MakeOperate/>

    <CAN />

    * Select **GPIO pins to set at micro-controller startup**, enter: **!gpio5**
    :::warning
        Please enter `!gpio5` in English input mode
    :::
        <ImageView image={require('@site/docs/ProductDoc/ToolBoard/fly-sb2040/sb2040-pro-v3/flash/img/can.webp').default} size="100%" align="center" />
    * Press `Q` key, **Save configuration** will appear, then press `Y` key
    <ImageView image={require('@site/docs/General/dfu-flash/img/configuration.webp').default} size="50%" align="center" />
    * Now the configuration should be saved and you should exit to the command line interface
    * Enter `make -j4` to start compilation, it will take some time
    <ImageView image={require('@site/docs/General/dfu-flash/img/make.webp').default} size="50%" align="center" />
    * If the following content is output, the compilation is successful

        ```bash
        Linking out/klipper.elf
        Creating hex file out/klipper.bin
        ```

## Search for Device

    <LS />

## Burn Firmware

    * Before burning the firmware, use an XT30 data cable to connect the tool board to the UTOC or the motherboard that has been flashed with the bridge firmware, the reference wiring diagram is below
    * Please ensure the dip switch is set to the correct position
        <ImageView image={require('@site/docs/ProductDoc/ToolBoard/fly-sb2040/sb2040-v3/flash/img/sb2040v3_utoc.webp').default} size="80%" align="left" />
    * Please ensure that the resistance between CAN H and CAN L is about `60立` when measured with a multimeter under power-off condition, if it is `120立`, the `120立` dip switch needs to be turned on, if it is about `40立`, the dip switch needs to be turned off
        <ImageView image={require('@site/docs/ProductDoc/ToolBoard/fly-sb2040/sb2040-v3/flash/img/120.webp').default} size="100%" align="center" />

    <CANFLASH />

## Confirm Firmware Startup

    * If the firmware starts normally, the LED will light up
        <ImageView image={require('@site/docs/ProductDoc/ToolBoard/fly-sb2040/sb2040-pro-v3/flash/img/led.webp').default} size="100%" align="center" />


