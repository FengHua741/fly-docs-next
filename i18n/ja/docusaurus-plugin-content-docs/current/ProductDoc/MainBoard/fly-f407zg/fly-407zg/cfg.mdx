---
sidebar_position: 5
sidebar_label: Klipperリファレンス設定
---

# Klipperリファレンス設定


    ```cfg
    ####################################################################################
    #                           3D MELLOW /FLY-9軸                                     #
    ####################################################################################
    ## FLY-9軸 資料ウェブサイト：
    ## FLY-9軸 回路図ウェブサイト：https://github.com/Mellow-3D/FLYF407ZG
    ## FLY 公式淘宝店：https://shop126791347.taobao.com/shop/view_shop.htm?spm=a230r.1.14.4.1a4840a8hyvpPJ&user_number_id=2464680006
    ## アフターサービスが必要な場合は淘宝カスタマーサービスに連絡してください
    ## FLY アフターサービス技術サポートグループ：621032883
    ## FLY-RRFファームウェア交流グループ：786561979

    #####################################################################
    #                               注意事項                               #
    #####################################################################
    ##***変更/確認が必要な項目：***
    ## MCU パス                              [mcu] 
    ## プリンタの動作範囲                           xyzのposition      
    ## サーミスタタイプ                             [extruder] と [heater_bed]
    ## Z軸リミットスイッチ停止位置                      [homing_override] 
    ## Z軸リミットスイッチオフセット位置                      [stepper_z] 
    ## PID キャリブレーション                               [extruder] と [heater_bed] 
    ## エクストルーダーモーターのステップ値微調整                     [extruder] 

    #####################################################################
    #                               ファイル呼び出し                               #
    #####################################################################
    #[include fluidd.cfg]          # FLUIDD呼び出しファイル。
    #[include mainsail.cfg]        # MAINSDIL呼び出しファイル。
    #どちらのファイルを使うかはご自身でご確認ください

    #####################################################################
    #                               メインボード設定                               #
    #####################################################################
    [mcu]                           # FLYボードID
    serial: /dev/serial/by-id/usb-Klipper_stm32f407xx_XXXXXXXXXXXXXXXXXXXXX
    ### usbファームウェアIDの確認方法：ls -l /dev/serial/by-id/
    ### /dev/serial/by-id/usb-Klipper_stm32f407xx_XXXXXXXXXXXXXXXXXXXXXを確認したIDに置き換えてください 

    #####################################################################
    #                            機種と加速度                            #
    #####################################################################
    [printer]                       # プリンタ設定
    kinematics: corexy              # 運動学構造：デカルト型やcorexyなど。デカルト型：cartesian
    max_velocity: 300               # プリンタ最大速度   
    max_accel: 3000                 # 最大加速度 最大3000
    max_z_velocity: 15              # z軸最大速度
    max_z_accel: 100                # z軸最大加速度
    square_corner_velocity: 5.0     # 角速度。小さくするとプラットフォームの慣性による影響を抑えられます

    #####################################################################
    #                             温度監視                               #
    #####################################################################
    [temperature_sensor Fly-9軸]     # FLYボード温度（任意でリネーム可）
    sensor_type: temperature_mcu     # mcuに関連付け（デフォルト）
    #--------------------------------------------------------------------
    [temperature_sensor FLY-π]        # ホスト温度
    sensor_type: temperature_host     # ホストに関連付け
    #--------------------------------------------------------------------
    # [temperature_sensor Box]          # ボックス内温度（温度センサー追加が必要、参考設定）
    # sensor_type: ATC Semitec 104GT-2  # センサー型番
    # sensor_pin: PA4                   # 信号ピン

    #####################################################################
    #                              ヒートベッドメッシュキャリブレーション
    #####################################################################
    [bed_mesh]
    speed: 50                    # キャリブレーション速度
    horizontal_move_z: 5         # プローブが次の点に移動する前にZを持ち上げる高さ
    mesh_min: 30,30              # 最小キャリブレーション点座標x，y
    mesh_max: 270, 270           # 最大キャリブレーション点座標x，y
    probe_count: 4,4             # サンプリング点数（4X4で16点）
    mesh_pps: 2,2                # 補間サンプリング点数
    algorithm: bicubic           # アルゴリズムモデル
    bicubic_tension: 0.2         # アルゴリズム補間は変更しないでください

    #####################################################################
    #             X/Yステッピングモーター設定 (X/Y Stepper Settings)                 # 
    #####################################################################
    #   B モーター ---- モーターA 
    #   |                  |
    #   |------エクストルーダー-------|
    #   |                  |
    #   |                  |
    #          正面   
    #####################################################################
    #                          X軸ステッピングモーター   (Bモーター)                    #
    #####################################################################
    ## Xモーターポート
    [stepper_x]
    step_pin: PB9                       # X軸モーターパルスピン設定
    dir_pin: PE0                        # X軸モーター方向ピン設定。方向は実際に応じて判断し、!を付けると逆転
    enable_pin: !PE1                    # X軸モーターイネーブルピン設定。イネーブルピンには!を付けないと動作しません
    rotation_distance: 40               # ドライブプーリー周長mm（2GT-20Tプーリー40，2GT-16Tプーリー32）
    microsteps: 16                      # モーターのマイクロステップ設定。高いほど品質向上、負荷増大
    full_steps_per_rotation: 200        # モーター1回転あたりのパルス数（1.8度モーター:200，0.9度モーター:400）
    endstop_pin: !PC3                   # リミットスイッチPIN。ノーマルクローズ推奨、!で状態反転。io-3
    ###ノーマルクローズでトリガー状態、!で状態反転。断線時のクラッシュ防止
    position_min: 0                     # ソフトリミット最小移動量
    position_endstop: 300               # ソフトリミット最大移動量 (250mm-300mm-350mm)
    position_max: 300                   # 機械リミット最大移動量 (250mm-300mm-350mm)
    homing_speed: 50                    # ホーミング速度。最大100。速すぎないよう推奨
    homing_retract_dist: 5              # 最初のリミットスイッチトリガー後のリトラクト距離
    step_pulse_duration: 0.000004
    #--------------------------------------------------------------------
    ##  ドライバー型番が正しいか確認 (2208 or 2209)
    [tmc2209 stepper_x]                 # Xドライバー設定 -TMC2209
    uart_pin: PG13                      # 通信ポートピン
    interpolate: False                  # 256マイクロステップ補間有効(True)/無効(False)
    run_current: 0.8                    # モーター駆動電流値（単位：mA）
    sense_resistor: 0.110               # ドライバーサンプル抵抗は変更しないでください
    stealthchop_threshold: 500          # 静音閾値（静音不要なら0に）
    #--------------------------------------------------------------------
    #[tmc5160 stepper_x]                 # エクストルーダードライバー設定- TMC5160
    #cs_pin: PG13                        # SPI チップセレクトピン
    #spi_bus: spi2                      # SPI バス
    #run_current: 1.0                    # モーター駆動電流値
    #interpolate: False                  # 256マイクロステップ補間有効(True)/無効(False)
    #sense_resistor: 0.075               # ドライバーサンプル抵抗は変更しないでください（5160 Proは0.033に）
    #stealthchop_threshold: 500          # 静音閾値（静音不要なら0に）

    #####################################################################
    #                       y軸ステッピングモーター   (Aモーター)                       #
    #####################################################################
    ## Yモーターポート
    [stepper_y]
    step_pin: PB8                       # Y軸モーターパルスピン設定
    dir_pin: PG11                       # Y軸モーター方向ピン設定。方向は実際に応じて判断し、!を付けると逆転
    enable_pin: !PG12                   # Y軸モーターイネーブルピン設定。イネーブルピンには!を付けないと動作しません
    rotation_distance: 40               # ドライブプーリー周長mm（2GT-20Tプーリー40，2GT-16Tプーリー32）
    microsteps: 16                      # モーターのマイクロステップ設定。高いほど品質向上、負荷増大
    full_steps_per_rotation: 200        # モーター1回転あたりのパルス数（1.8度モーター:200，0.9度モーター:400）
    endstop_pin: !PF2                   # リミットスイッチPIN。ノーマルクローズ推奨、!で状態反転。io-0
    ###ノーマルクローズでトリガー状態、!で状態反転。断線時のクラッシュ防止
    position_min: 0                     # ソフトリミット最小移動量
    position_endstop: 300               # ソフトリミット最大移動量 (250mm-300mm-350mm)
    position_max: 300                   # 機械リミット最大移動量 (250mm-300mm-350mm)
    homing_speed: 50                    # ホーミング速度。最大100。速すぎないよう推奨
    homing_retract_dist: 5              # 最初のリミットスイッチトリガー後のリトラクト距離
    step_pulse_duration: 0.000004
    #--------------------------------------------------------------------
    ##  ドライバー型番が正しいか確認 (2208 or 2209)
    [tmc2209 stepper_y]                 # Yドライバー設定 -TMC2209
    uart_pin: PG10                      # 通信ポートピン
    interpolate: False                  # 256マイクロステップ補間有効(True)/無効(False)
    run_current: 0.8                    # モーター駆動電流値（単位：mA）
    sense_resistor: 0.110               # ドライバーサンプル抵抗は変更しないでください
    stealthchop_threshold: 500          # 静音閾値（静音不要なら0に）
    #--------------------------------------------------------------------
    #[tmc5160 stepper_y]                 # エクストルーダードライバー設定- TMC5160
    #cs_pin: PG10                        # SPI チップセレクトピン
    #spi_bus: spi2                      # SPI バス
    #run_current: 1.0                    # モーター駆動電流値
    #interpolate: False                  # 256マイクロステップ補間有効(True)/無効(False)
    #sense_resistor: 0.075               # ドライバーサンプル抵抗は変更しないでください（5160 Proは0.033に）
    #stealthchop_threshold: 500          # 静音閾値（静音不要なら0に）

    #####################################################################
    #                     Z軸ステッピングモーター （Z Stepper Settings）              #
    #####################################################################
    #   |----- Z1 -----|
    #   |              |
    #   |              |
    #   |              |
    #   Z0----ディスプレイ----Z2

    #####################################################################
    #                           Z軸ステッピングモーター                              #
    #####################################################################
    ##    Zステッピングモーター - 左前方 zポート
    [stepper_z]
    step_pin: PA8                  # z軸モーターパルスピン設定
    dir_pin: !PD6                  # z軸モーター方向ピン設定。方向は実際に応じて判断し、!を付けると逆転
    enable_pin: !PD7               # z軸モーターイネーブルピン設定。イネーブルピンには!を付けないと動作しません
    ### T8x4リードスクリュー。1回転でベッドが4mm移動 
    ## 購入したリードスクリューに合わせて変更してください
    rotation_distance: 4          # リードスクリューリード4
    full_steps_per_rotation: 200  # モーター1回転あたりのパルス数（1.8度モーター:200，0.9度モーター:400
    microsteps: 16                # モーターのマイクロステップ設定。高いほど品質向上、負荷増大
    endstop_pin: !PF0             # リミットスイッチPIN。ノーマルクローズ推奨、!で状態反転。io-1
    ## position_endstopはノズルがベッド表面(Z0)からZリミットスイッチトリガー点までの距離(mm)
    ## 正の値=ベッドより高い終点、負の値=ベッドより低い終点
    ## position_endstopの値を増やすとノズルがベッドに近づきます
    ## Z_ENDSTOP_CALIBRATE実行後、position_endstopはCFGの最後に保存されます
    position_min: -15             # （ノズルクリーニング設定時は-5程度）
    position_max: 300             # 機械リミット最大移動量 (250mm-300mm-350mm)
    homing_speed: 5               # ホーミング速度-最大20
    second_homing_speed: 3        # 2回目のホーミング速度-最大10
    homing_retract_dist: 0        # リトラクト距離
    step_pulse_duration: 0.000004
    #--------------------------------------------------------------------
    [tmc2209 stepper_z]
    uart_pin: PD5                 # ドライバー通信ポート
    interpolate: False            # 256マイクロステップ補間有効(True)/無効(False)
    run_current: 0.8              # 駆動電流mA
    sense_resistor: 0.110         # ドライバーサンプル抵抗は変更しないでください
    stealthchop_threshold: 500    # 静音閾値（静音不要なら0に）
    #--------------------------------------------------------------------
    #[tmc5160 stepper_z]                 # エクストルーダードライバー設定- TMC5160
    #cs_pin: PD5                         # SPI チップセレクトピン
    #spi_bus: spi2                      # SPI バス
    #run_current: 1.0                    # モーター駆動電流値
    #interpolate: False                  # 256マイクロステップ補間有効(True)/無効(False)
    #sense_resistor: 0.075              # ドライバーサンプル抵抗は変更しないでください（5160 Proは0.033に）
    #stealthchop_threshold: 500          # 静音閾値（静音不要なら0に）
    #--------------------------------------------------------------------

    ##    Z1 ステッピングモーター - 後方E0ポート
    [stepper_z1]
    step_pin: PC7                 # z1軸モーターパルスピン設定
    dir_pin: !PD3                 # z1軸モーター方向ピン設定。方向は実際に応じて判断し、!を付けると逆転
    enable_pin: !PD4              # z1軸モーターイネーブルピン設定。イネーブルピンには!を付けないと動作しません
    ### T8x4リードスクリュー。1回転でベッドが4mm移動 
    ## 購入したリードスクリューに合わせて変更してください
    rotation_distance: 4          # リードスクリューリード4
    full_steps_per_rotation: 200  # モーター1回転あたりのパルス数（1.8度モーター:200，0.9度モーター:400
    microsteps: 16                # モーターのマイクロステップ設定。高いほど品質向上、負荷増大
    step_pulse_duration: 0.000004
    #--------------------------------------------------------------------
    [tmc2209 stepper_z1]
    uart_pin: PD1                 # ドライバー通信ポート
    #interpolate: False                  # 256マイクロステップ補間有効(True)/無効(False)
    run_current: 0.8              # 駆動電流mA
    sense_resistor: 0.110         # ドライバーサンプル抵抗は変更しないでください
    stealthchop_threshold: 500    # 静音閾値（静音不要なら0に）
    #--------------------------------------------------------------------
    #[tmc5160 stepper_z1]                # エクストルーダードライバー設定- TMC5160
    #cs_pin: PD1                         # SPI チップセレクトピン
    #spi_bus: spi2                      # SPI バス
    #run_current: 1.0                    # モーター駆動電流値
    #interpolate: False                  # 256マイクロステップ補間有効(True)/無効(False)
    #sense_resistor: 0.075              # ドライバーサンプル抵抗は変更しないでください（5160 Proは0.033に）
    #stealthchop_threshold: 500          # 静音閾値（静音不要なら0に）
    #--------------------------------------------------------------------

    ##    Z2 ステッピングモーター - 右前方E1ポート    
    [stepper_z2]
    step_pin: PC6                 # z2軸モーターパルスピン設定
    dir_pin: !PA15                 # z2軸モーター方向ピン設定。方向は実際に応じて判断し、!を付けると逆転
    enable_pin: !PD0             # z2軸モーターイネーブルピン設定。イネーブルピンには!を付けないと動作しません
    ### T8x4リードスクリュー。1回転でベッドが4mm移動 
    ## 購入したリードスクリューに合わせて変更してください
    rotation_distance: 4          # リードスクリューリード4
    full_steps_per_rotation: 200  # モーター1回転あたりのパルス数（1.8度モーター:200，0.9度モーター:400
    microsteps: 16                # モーターのマイクロステップ設定。高いほど品質向上、負荷増大
    step_pulse_duration: 0.000004
    #--------------------------------------------------------------------
    [tmc2209 stepper_z2]
    uart_pin: PA14                # ドライバー通信ポート
    #interpolate: False                  # 256マイクロステップ補間有効(True)/無効(False)
    run_current: 0.8              # 駆動電流mA
    sense_resistor: 0.110         # ドライバーサンプル抵抗は変更しないでください
    stealthchop_threshold: 500    # 静音閾値（静音不要なら0に）
    #--------------------------------------------------------------------
    #[tmc5160 stepper_z2]                # エクストルーダードライバー設定- TMC5160
    #cs_pin: PA14                         # SPI チップセレクトピン
    #spi_bus: spi2                      # SPI バス
    #run_current: 1.0                    # モーター駆動電流値
    #interpolate: False                  # 256マイクロステップ補間有効(True)/無効(False)
    #sense_resistor: 0.075              # ドライバーサンプル抵抗は変更しないでください（5160 Proは0.033に）
    #stealthchop_threshold: 500          # 静音閾値（静音不要なら0に）

    #####################################################################
    #                        エクストルーダー設定 （E0 Settings）                   # 
    #####################################################################
    #E5モーターポート
    [extruder]                          # エクストルーダー
    step_pin: PD12                      # エクストルーダーパルスピン
    dir_pin: !PD8                       # エクストルーダー方向ピン
    enable_pin: !PD9                    # エクストルーダーイネーブルピン
    ## エクストルーダーキャリブレーション時は以下の値を更新
    ## 例：100mm送りたいが実際は102mmだった場合：
    ## rotation_distance = <旧rotation_distance> * <実際の押出長> / <要求長>
    ## キャリブレーション値: 22.44=旧値22*実測102/目標100
    rotation_distance: 22.44            # ステップ値
    gear_ratio: 50:17                   # 減速比（ガリレオギア比7.5:1はコメントアウト、BMGは50:17、出力軸前・入力軸後）
    microsteps: 16                      # モーターのマイクロステップ設定。高いほど品質向上、負荷増大
    full_steps_per_rotation: 200        # 1回転あたりのパルス数（200は1.8度、400は0.9度）
    nozzle_diameter: 0.400              # ノズル径
    filament_diameter: 1.75             # フィラメント径
    heater_pin: PF7                     # ヒーターカートリッジピン
    sensor_type: ATC Semitec 104GT-2    # センサー型番  (Generic 3950, ATC Semitec 104GT-2， PT1000)
    sensor_pin: PA0                     # センサーピン、ADC_0に接続   
    min_temp: 10                        # 最低温度（注意：測定温度が設定値を超えると緊急停止）
    max_temp: 350                       # 最高温度（注意：測定温度が設定値を超えると緊急停止）
    max_power: 1.0                      # 最大出力
    min_extrude_temp: 170               # 最低押出温度（この温度以上で押出可能）
    pressure_advance: 0.05              # プレッシャーアドバンス。1.0以下推奨
    #プレッシャーアドバンス調整方法:https://www.klipper3d.org/ja/Pressure_Advance.html
    pressure_advance_smooth_time: 0.040 # スムーズタイム。デフォルト0.040
    #max_extrude_only_distance: 200.0   # 押出量エラー時はコメントアウト可。再スライス推奨
    #ノズルPIDキャリブレーションコマンド：  "PID_CALIBRATE HEATER=extruder TARGET=245
    control = pid                # PIDノズル温度自動キャリブレーション（完了後コメントアウト）
    pid_kp = 26.213              # PIDノズル温度自動キャリブレーション（完了後コメントアウト）
    pid_ki = 1.304               # PIDノズル温度自動キャリブレーション（完了後コメントアウト）
    pid_kd = 131.721             # PIDノズル温度自動キャリブレーション（完了後コメントアウト）
    step_pulse_duration: 0.000004
    #--------------------------------------------------------------------
    [tmc2209 extruder]                  # エクストルーダードライバー設定- TMC2209
    uart_pin: PB12                      # 通信ポートピン
    interpolate: False                  # 256マイクロステップ補間有効(True)/無効(False)
    run_current: 0.8                    # モーター駆動電流値
    sense_resistor: 0.110               # ドライバーサンプル抵抗は変更しないでください
    stealthchop_threshold: 500          # 静音閾値（静音不要なら0に）
    #--------------------------------------------------------------------
    #[tmc5160 extruder]                  # エクストルーダードライバー設定- TMC5160
    #cs_pin: PB12                        # SPI チップセレクトピン
    #spi_bus: spi2                      # SPI バス
    #run_current: 1.0                    # モーター駆動電流値
    #interpolate: False                  # 256マイクロステップ補間有効(True)/無効(False)
    #sense_resistor: 0.075              # ドライバーサンプル抵抗は変更しないでください（5160 Proは0.033に）
    #stealthchop_threshold: 500          # 静音閾値（静音不要なら0に）

    #####################################################################
    #                            ヒートベッド設定                                # 
    #####################################################################
    [heater_bed]
    heater_pin: PE2              # ヒートベッドピン
    sensor_type: Generic 3950    # ヒートベッドセンサー型番
    sensor_pin:  PF3             # ヒートベッドセンサーピン
    max_power: 1.0               # ヒートベッド出力
    min_temp: 0                  # 最低温度（注意：測定温度が設定値を超えると緊急停止）
    max_temp: 120                # 最高温度（注意：測定温度が設定値を超えると緊急停止）
    # ヒートベッドPIDキャリブレーションコマンド：  "PID_CALIBRATE HEATER=heater_bed TARGET=100"
    control: pid                # PIDヒートベッド温度自動キャリブレーション（完了後コメントアウト）
    pid_kp: 58.437              # PIDヒートベッド温度自動キャリブレーション（完了後コメントアウト）
    pid_ki: 2.347               # PIDヒートベッド温度自動キャリブレーション（完了後コメントアウト）
    pid_kd: 363.769             # PIDヒートベッド温度自動キャリブレーション（完了後コメントアウト）

    #####################################################################
    #                            ファン設定                                # 
    #####################################################################
    [fan]                        # モデル冷却ファン
    pin: PF8                     # 信号ピン
    kick_start_time: 0.5         # 起動時間（変更不可）
    off_below: 0.10              # 変更不可
    #--------------------------------------------------------------------
    [heater_fan hotend_fan]      # ホットエンドファン
    pin: PF9                     # 信号ピン
    max_power: 1.0               # 最大回転数
    kick_start_time: 0.5         # 起動時間（変更不可）
    heater: extruder             # 関連デバイス：エクストルーダー
    heater_temp: 50              # エクストルーダーが何度でファン起動
    fan_speed: 1.0               # ファン回転数
    #--------------------------------------------------------------------
    [heater_fan controller_fan]  # コントローラーファン
    pin: PA2                     # 信号ピン
    max_power: 1.0               # 最大回転数
    kick_start_time: 0.5         # 起動時間（変更不可）
    heater: heater_bed           # 関連デバイス：ヒートベッド
    heater_temp: 50              # ヒートベッドが何度でファン起動
    fan_speed: 1.0               # ファン回転数
    #--------------------------------------------------------------------
    [heater_fan exhaust_fan]     # 排気ファン
    pin: PA1                     # 信号ピン
    max_power: 1.0               # 最大回転数
    kick_start_time: 0.5         # 起動時間（変更不可）
    heater: heater_bed           # 関連デバイス：ヒートベッド
    heater_temp: 70              # ヒートベッドが何度でファン起動
    fan_speed: 1.0               # ファン回転数

    #####################################################################
    #                           アイドル時ヒートベッドオフ                             #
    #####################################################################
    [idle_timeout]
    timeout: 1800                # アイドル30分でヒートベッドオフ

    #####################################################################
    #                           レベリングセンサー                               #
    #####################################################################
    #デフォルトPL08Nセンサーはノズルより低くしないでください。レベリング専用。PL08NがNO（ノーマルオープン）の場合は!を追加
    [probe]
    pin: PC14                    # リミットスイッチPIN。ノーマルクローズ推奨、!で状態反転。io-2
    x_offset: 0                  # X軸-センサーのノズルからのオフセット
    y_offset: 25.0               # Y軸-センサーのノズルからのオフセット
    z_offset: 0                  # Z軸-センサーのノズルからのオフセット
    speed: 10.0                  # レベリング速度
    samples: 3                   # サンプリング回数
    samples_result: median       # 取得方法（デフォルトmedian-中央値）
    sample_retract_dist: 4.0     # レベリングリトラクト距離
    samples_tolerance: 0.006     # サンプリング公差（小さすぎると回数増加）
    samples_tolerance_retries: 3 # 公差超過時の再試行回数
    #--------------------------------------------------------------------
    #[bltouch]
    #sensor_pin: PC14             # 信号ピン
    #control_pin：PE11            # サーボピン(SERVOO)
    #x_offset: 0                  # X軸-センサーのノズルからのオフセット
    #y_offset: 25.0               # Y軸-センサーのノズルからのオフセット
    #z_offset: 0                  # Z軸-センサーのノズルからのオフセット

    #####################################################################
    #                               ホーミング                                #
    #####################################################################
    # [safe_z_home]                # Z軸リミット座標
    # home_xy_position:206,300     # Z軸リミット位置定義（重要！ご自身で調整）
    # speed:100                    # ホーミング速度
    # z_hop:10                     # ホーミング後の持ち上げ高さ
    #--------------------------------------------------------------------
    [homing_override]                   # Z軸ホーミングマクロ（Klicky使用時はコメントアウト）
    axes: z
    set_position_z: 0
    gcode:
    G90
    G0 Z5 F600
    G28 X Y
    ## Zリミットスイッチ位置
    ## 数回テストし、問題なければXとYをご自身の値に更新（例：X157, Y305）
    ## 終了ピン位置定義ステップ。
    G0 X-10 Y-10 F3600               # ここでXとYの値を更新
        
    G28 Z
    G0 Z10 F1800
        
        ##  ご自身の機種サイズに合わせて該当行の「#」を削除してください
        ##  おおよその中央です
    #--------------------------------------------------------------------
        ##  250mm機種は下記行の「#」を削除して有効化
        #G0 X125 Y125 Z30 F3600
    #--------------------------------------------------------------------   
        ##  300mm機種は下記行の「#」を削除して有効化
        #G0 X150 Y150 Z30 F3600
    #--------------------------------------------------------------------
        ##  350mm機種は下記行の「#」を削除して有効化
        #G0 X175 Y175 Z30 F3600
    #--------------------------------------------------------------------

    #####################################################################
    #   3Zレベリング 
    #####################################################################
    [z_tilt]
    ##  Z_TILT_ADJUSTコマンドでヒートベッドをレベリング
    ##  z_positions: ヘッド位置

    ##--------------------------------------------------------------------
    ##  250mm機種は下記の「#」を削除して有効化
    #z_positions:
    #   -50, 18
    #   125, 298
    #   300, 18
    #points:
    #   30, 5
    #   125, 195
    #   220, 5
    ##--------------------------------------------------------------------
    ##  300mm機種は下記の「#」を削除して有効化
    #z_positions:
    #   -50, 18
    #   150, 348
    #   350, 18
    #points:
    #   30, 5
    #   150, 245
    #   270, 5
    ##--------------------------------------------------------------------
    ##  350mm機種は下記の「#」を削除して有効化
    #z_positions:
    #   -50, 18
    #   175, 398
    #   400, 18
    #points:
    #   30, 5
    #   175, 295
    #   320, 5
    #--------------------------------------------------------------------
    speed: 100                   # レベリング速度
    horizontal_move_z: 10        # Z軸開始高さ
    retry_tolerance: 0.0075      # サンプリング公差
    retries: 5                   # 公差超過時の再試行回数
    max_adjust: 10               # レベリング最大調整量

    #####################################################################
    #                      FLY-Mini 12864 LCD
    #####################################################################
    [board_pins]
    aliases:
        EXP1_1=PB10, EXP1_3=P314,  EXP1_5=PE10,  EXP1_7=PE8,  EXP1_9=<GND>,
        EXP1_2=PE13, EXP1_4=PG8,  EXP1_6=,   EXP1_8=PE7,  EXP1_10=<5V>,
        # EXP2 header
        EXP2_1=PA6, EXP2_3=PB7,  EXP2_5=PB6,  EXP2_7=PG15,   EXP2_9=<GND>,
        EXP2_2=PA5, EXP2_4=PA4,  EXP2_6=PA7,  EXP2_8=<RST>,  EXP2_10=<NC>,
    #--------------------------------------------------------------------    
    #[display]
    #lcd_type: uc1701
    #cs_pin: EXP1_3
    #a0_pin: EXP1_4
    #rst_pin: EXP1_5
    #contrast: 63
    #encoder_pins: ^EXP2_5, ^!EXP2_3
    #click_pin: ^!EXP1_2
    ##spi_bus: spi1
    #--------------------------------------------------------------------
    #####FLY Mini12864用
    #[neopixel fly_mini12864]
    #pin: EXP1_6                     # LCDバックライト制御ピン
    #chain_count: 3
    #initial_RED: 1.0                # 赤LED輝度（0-1）
    #initial_GREEN: 1.0              # 緑LED輝度（0-1）
    #initial_BLUE: 1.0               # 青LED輝度（0-1）
    #color_order: RGB                # カラー順

    #####################################################################
    #                          アイドル時ヒートベッドオフ
    #####################################################################
    [idle_timeout]
    timeout: 1800                # アイドル30分でヒートベッドオフ

    #####################################################################
    #                           カスタムgcodeマクロ                            #
    #####################################################################
    [gcode_macro PRINT_START]          # PRINT_STARTを印刷開始時のマクロに設定。印刷前の動作をカスタマイズ
    gcode:
        G92 E0                         # エクストルーダーリセット
        BED_MESH_CLEAR                 # ベッドメッシュ解除
        G28                            # 全軸ホーミング
        Z_TILT_ADJUST                  # ガントリーレベリング
        G28                            # 全軸ホーミング
        G1 Z20 F3000                   # ノズルをベッドから離す
        BED_MESH_PROFILE LOAD=default  # ベッドメッシュ読み込み
    #--------------------------------------------------------------------
    [gcode_macro PRINT_HUAXIAN]        # PRINT_HUAXIANをPRINT_START後のマクロに設定。印刷前の動作をカスタマイズ
    gcode:
        G1 Z5 F3000 
        G92 E0;              # エクストルーダーリセット
        G90                  # 絶対座標系設定
        G0 X5 Y1 F6000       # x5 y1に移動、速度100mm/s（F6000は6000mm/分）
        G0 Z0.4              # z軸を0.4に移動
        G91                  # 相対座標系設定
        G1 X100 E20 F1200;   # x軸100mm移動しつつ押出。Fで押出速度調整
        G1 Y1                # y軸1mm移動
        G1 X-100 E20 F1200;  # 逆方向にx軸100mm移動しつつ押出。Fで押出速度調整
        G0 z5                # z軸5mm上昇
        G1 E-5.0 F3600       # フィラメントリトラクト
        G92 E0;              # エクストルーダーリセット
        G90                  # 絶対座標系設定 

    #--------------------------------------------------------------------
    [gcode_macro PRINT_END]            # PRINT_ENDを印刷終了時のマクロに設定。印刷後の動作をカスタマイズ
    gcode:
        #   境界取得
        {% set max_x = printer.configfile.config["stepper_x"]["position_max"]|float %}
        {% set max_y = printer.configfile.config["stepper_y"]["position_max"]|float %}
        {% set max_z = printer.configfile.config["stepper_z"]["position_max"]|float %}
        
        #   終了位置を確認し、安全な移動方向を決定
        {% if printer.toolhead.position.x < (max_x - 20) %}
            {% set x_safe = 20.0 %}
        {% else %}
            {% set x_safe = -20.0 %}
        {% endif %}

        {% if printer.toolhead.position.y < (max_y - 20) %}
            {% set y_safe = 20.0 %}
        {% else %}
            {% set y_safe = -20.0 %}
        {% endif %}

        {% if printer.toolhead.position.z < (max_z - 2) %}
            {% set z_safe = 2.0 %}
        {% else %}
            {% set z_safe = max_z - printer.toolhead.position.z %}
        {% endif %}
        
        M400                              # バッファクリア待機
        G92 E0                            # エクストルーダーリセット
        G1 E-10.0 F3600                   # フィラメントリトラクト
        G91                               # 相対位置指定
        G0 Z{z_safe} F3600                # ガントリー上昇
        G0 X{x_safe} Y{y_safe} F20000     # ノズルを後方に移動
        M104 S0                           # ホットエンドオフ
        M140 S0                           # ヒートベッドオフ
        M106 S0                           # モデルファンオフ
        G90                               # 絶対座標系設定
        G0 X{max_x / 2} Y{max_y} F3600    # ノズルを後方中央に移動
        BED_MESH_CLEAR                    # ベッドメッシュ解除

    ```
