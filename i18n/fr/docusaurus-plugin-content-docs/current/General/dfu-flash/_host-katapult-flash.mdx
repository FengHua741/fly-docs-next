:::astuce
    * Lors de l'installation du plug-in de gravure, une connexion Internet est nécessaire. Veuillez vous assurer que votre ordinateur de contrôle est correctement connecté à Internet.
    * Si le plug-in a déjà été installé, il n'est pas nécessaire de le réinstaller.
:::

### Démarrer la gravure

    :::avertissement Avertissement
       * **Non FLY PC** : Veuillez impérativement exécuter le code ci-dessous pour installer les paquets de dépendances nécessaires à la gravure ! Sinon, la gravure des firmwares ne fonctionnera pas !
       ```
      cd && git clone https://github.com/Arksine/katapult.git
       ```
      <ImageView image={require('@site/docs/General/dfu-flash/img/get_katapult.webp').default} size="80%" align="center" />
    :::
    * Utilisez la commande ci-dessous pour rechercher l'ID de votre appareil, un ID similaire à celui de l'image ci-dessous doit apparaître (remarque : l'ID de l'image est fourni à titre indicatif, chaque carte mère a un ID différent)

        ```bash
        ls /dev/serial/by-id/*
        ```
        <ImageView image={require('@site/docs/General/dfu-flash/img/2040.webp').default} size="80%" align="center" />


    * Pour graver le firmware, utilisez la commande ci-dessous, assurez-vous d'avoir compilé le firmware, et remplacez `<votre ID de carte mère>` par l'ID trouvé dans l'étape précédente

        ```bash
        ~/klippy-env/bin/python ~/katapult/scripts/flashtool.py -d /dev/serial/by-id/<votre ID de carte mère>
        ```

    * Référence ci-dessous
        <ImageView image={require('@site/docs/General/dfu-flash/img/kaulut7.webp').default} size="100%" align="center" />

    * Référence après la gravure
        <ImageView image={require('@site/docs/General/dfu-flash/img/katapult3.webp').default} size="100%" align="center" />

## Mise à jour du firmware

<Tabs>
    <TabItem value="w" label="Mise à jour du firmware USB" default>
    * Utilisez la commande ci-dessous pour rechercher l'ID de votre carte mère, un ID similaire à celui de l'image ci-dessous doit apparaître (remarque : l'ID de l'image est fourni à titre indicatif, chaque carte mère a un ID différent)

        ```bash
        ls /dev/serial/by-id/*
        ```
    :::astuce Remarque
        L'ID `/dev/serial/by-id/usb-katapult_rp2040_E662549553642032-if00` de l'image correspond à l'ID de la carte mère.
    :::
        <ImageView image={require('@site/docs/General/dfu-flash/img/2040.webp').default} size="80%" align="center" />

    * La mise à jour du firmware USB nécessite de compiler le dernier firmware, puis d'exécuter la commande suivante, en remplaçant `<votre ID de carte mère>` par l'ID trouvé à l'étape précédente

        ```bash
        cd ~/klipper/ && make flash FLASH_DEVICE=<votre ID de carte mère>
        ```
       <ImageView image={require('@site/docs/General/dfu-flash/img/katapult5.webp').default} size="100%" align="center" />
    </TabItem>


    <TabItem value="l" label="Mise à jour du firmware CAN via pont">
    * Pour mettre à jour le firmware CAN via pont, il est nécessaire de compiler le dernier firmware, puis d'exécuter la commande suivante pour réinitialiser Katapult. (L'ID de l'image ci-dessous est fourni à titre indicatif, veuillez utiliser l'ID spécifié dans votre fichier de configuration)
    :::astuce Remarque
       * `<votre UUID CANBUS>` correspond à l'UUID CANBUS de la carte mère dans le fichier de configuration **printer.cfg**
    :::
        
        <br/>

        ```bash
        ~/klippy-env/bin/python3 ~/katapult/scripts/flashtool.py -i can0 -r -u <votre UUID CANBUS>
        ```
    :::astuce Remarque
       * L'UUID CANBUS `f95cee90e1f9` de l'image ci-dessous est fourni à titre indicatif.
    :::
        <ImageView image={require('@site/docs/General/dfu-flash/img/katapult6.webp').default} size="100%" align="center" />
    * Après avoir réinitialisé Katapult, utilisez la commande suivante pour rechercher l'ID de votre carte mère, un ID similaire à celui de l'image ci-dessous doit apparaître (remarque : l'ID de l'image est fourni à titre indicatif, chaque carte mère a un ID différent)

        ```bash
        ls /dev/serial/by-id/*
        ```
    :::astuce Remarque
        L'ID `/dev/serial/by-id/usb-Klipper_stm32f072xb_43002C000951324757373520-if00` de l'image correspond à l'ID de la carte mère.
    :::
        <ImageView image={require('@site/docs/General/dfu-flash/img/katapult4.webp').default} size="80%" align="center" />

    * Assurez-vous d'avoir compilé le nouveau firmware avant d'exécuter la gravure. Remplacez `<votre ID de carte mère>` par l'ID trouvé à l'étape précédente

        ```bash
        cd ~/klipper/ && make flash FLASH_DEVICE=<votre ID de carte mère>
        ```
       <ImageView image={require('@site/docs/General/dfu-flash/img/katapult5.webp').default} size="100%" align="center" />
    </TabItem>

</Tabs>

## Solution pour la gravure incorrecte du firmware

* Éteignez la carte mère, réallumez-la, puis appuyez rapidement deux fois sur le bouton reset pour réactiver le mode de gravure.
* Ou bien, utilisez une machine Windows/ordinateur principal pour regraver le firmware Katapult en suivant ce lien<Button variant="contained" disableElevation href="/docs/ProductDoc/MainBoard/fly-d/fly-d5/flash/bl#entrer-en-mode-de-gravage-dfu">Graver le firmware Katapult</Button>
